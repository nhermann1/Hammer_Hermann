geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#labs(linetype = "Year", shape = "Year")+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#labs(linetype = "Year", shape = "Year")+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS3)),
aes(x=MDS1,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS3)),
aes(x=MDS1,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 3")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS3)),
aes(x=MDS1,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 3")
ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS2,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 2")+ylab("Axis 3")
axes12<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
axes13<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS3)),
aes(x=MDS1,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 3")
axes23<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS2,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 2")+ylab("Axis 3")
grid.arrange(axes12,axes13,axes23)
axes23<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
scales_y_continuous(breaks=c(-1,0,1))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS2,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 2")+ylab("Axis 3")
grid.arrange(axes12,axes13,axes23)
axes23<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
scale_y_continuous(breaks=c(-1,0,1))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS2,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 2")+ylab("Axis 3")
grid.arrange(axes12,axes13,axes23)
axes12<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")
axes13<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS3)),
aes(x=MDS1,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 3")
axes12<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")+
theme(legend.position=NULL)
axes12
axes12<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=7,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS2,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS2,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 2")+
theme(legend.position="none")
axes13<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS1,MDS3)),
aes(x=MDS1,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS1,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
#geom_text(aes(x=-1.6,y=-1.6,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS1,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS1,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 1")+ylab("Axis 3")
axes23<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
scale_y_continuous(breaks=c(-1,0,1))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS2,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 2")+ylab("Axis 3")+
legend.position="none"
grid.arrange(axes12,axes13,axes23)
axes23<-ggplot()+
geom_polygon(data=NMDS_scores%>%group_by(family=allEnv.Mat$family,Year=as.character(allEnv.Mat$Year))%>%slice(chull(MDS2,MDS3)),
aes(x=MDS2,y=MDS3,group=paste(family,Year),color=family,lty=Year),alpha=0.1,lwd=1.5)+
geom_point(data=NMDS_scores,aes(MDS2,MDS3,fill=allEnv.Mat$family,shape=as.character(allEnv.Mat$Year)),color="black",size=6)+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=gsub("prey_","",row.names(NMDS_species))))+
scale_fill_viridis_d(option="E",name="Family")+
scale_color_viridis_d(option="E",name="Family",guide="none")+
scale_shape_manual(values=c(21,22,23),name="Year")+
scale_linetype_manual(values=c(1,5,3))+
scale_y_continuous(breaks=c(-1,0,1))+
guides(fill=guide_legend(override.aes = list(shape=21,size=20)),
linetype=guide_legend(override.aes=list(color="black",size=20,fill="transparent")))+
geom_text(aes(x=-1.9,y=-1.2,label=paste0("Stress: ",round(actualStress*100,2))),size=6,hjust=0)+
geom_point(data=spyrCentoids,aes(MDS2,MDS3,fill=Group.1,shape=as.character(Group.2)),
color="red",size=12,stroke=2,alpha=0.7,show.legend=F)+
geom_label(data=spyrCentoids,aes(MDS2,MDS3,label=lab),
color="red",size=3,alpha=0.7,show.legend=F)+
xlab("Axis 2")+ylab("Axis 3")+
theme(legend.position="none")
grid.arrange(axes12,axes13,axes23)
library(ggpubr)
ggarrange(axes12,axes13,axes23,common.legend = T,legend="top")
ggarrange(axes12,axes13,axes23,common.legend = T,legend="top",ncol=1)
library(rgl)
interleave <- function(v1, v2) as.vector(rbind(v1,v2))
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
text3d(NMDS_species$MDS1,
NMDS_species$MDS2,
NMDS_species$MDS3,
texts=gsub("prey_","",row.names(NMDS_species)),add=T)
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
text3d(NMDS_species$MDS1,
NMDS_species$MDS2,
NMDS_species$MDS3,
texts=gsub("prey_","",row.names(NMDS_species)),add=T)
play3d(spin3d())
movie3d(spin3d())
movie3d(spin3d(duration=20))
movie3d(spin3d(),duration=20)
movie3d(spin3d(axis=c(1,0,0), rpm=4),duration=20)
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
text3d(NMDS_species$MDS1,
NMDS_species$MDS2,
NMDS_species$MDS3,
texts=gsub("prey_","",row.names(NMDS_species)),add=T)
movie3d(spin3d(axis=c(1,0,0), rpm=4),duration=20)
warnings()
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
text3d(NMDS_species$MDS1,
NMDS_species$MDS2,
NMDS_species$MDS3,
texts=gsub("prey_","",row.names(NMDS_species)),add=T)
play3d(spin3d())
movie3d(spin3d(axis=c(1,0,0), rpm=4),duration=20)
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
text3d(NMDS_species$MDS1,
NMDS_species$MDS2,
NMDS_species$MDS3,
texts=gsub("prey_","",row.names(NMDS_species)),add=T)
movie3d(spin3d(axis=c(1,0,0), rpm=4),duration=20)
getwd()
plot3d(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,
size=8,col=allEnv.Mat$famCol)
segments3d(interleave(0, NMDS_species$MDS1),
interleave(0, NMDS_species$MDS2),
interleave(0, NMDS_species$MDS3),
alpha = 0.4, col = "blue")
text3d(NMDS_species$MDS1,
NMDS_species$MDS2,
NMDS_species$MDS3,
texts=gsub("prey_","",row.names(NMDS_species)),add=T)
