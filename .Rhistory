dplyr::select(species,Year,matches("^prey"))%>%
group_by(species,Year)%>%
summarise_each(funs=sum)
View(fooYears)
#Separated by years
presenceYears<-dietMat%>%
mutate(species=ifelse(Species=="Arctic char","Arctic char","Sculpin"))%>%
dplyr::select(species,Year,matches("^prey"))%>%
group_by(species,Year)%>%
summarise_each(funs=sum)
totalYears<-dietMat%>%
mutate(species=ifelse(Species=="Arctic char","Arctic char","Sculpin"))%>%
dplyr::select(species,Year,matches("^prey"))%>%
group_by(species,Year)%>%
summarise_each(funs=n)
totalYears<-dietMat%>%
mutate(species=ifelse(Species=="Arctic char","Arctic char","Sculpin"))%>%
dplyr::select(species,Year,matches("^prey"))%>%
group_by(species,Year)%>%
summarise_each(funs=n())
totalYears<-dietMat%>%
mutate(species=ifelse(Species=="Arctic char","Arctic char","Sculpin"))%>%
dplyr::select(species,Year,matches("^prey"))%>%
group_by(species,Year)%>%
summarise_each(funs=count)
group_by(species,Year)%>%
summarise(N=n())
totalYears<-dietMat%>%
mutate(species=ifelse(Species=="Arctic char","Arctic char","Sculpin"))%>%
group_by(species,Year)%>%
summarise(N=n())
View(totalYears)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"))
View(fooYears)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
mutate(prey=gsub("^prey","",prey),
prey=gsub("\\.","\n",prey),
foo=noo/n)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey","",prey),
prey=gsub("\\.","\n",prey),
foo=noo/n)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey","",prey),
prey=gsub("\\.","\n",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.","\n",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.","\n",prey),
prey=gsub("sp$","sp\\.",prey),
foo=noo/N)
View(fooYears)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.","\n",prey),
prey=gsub("sp$","sp\.",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.","\n",prey),
prey=gsub("sp$","sp\\.",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.","\n",prey),
prey=gsub("sp$","sp\\.$",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])","\n(\1)",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])","\n\1",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.(A-z)","\n\1",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])","\n[\1]",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])","\n\1",prey),
foo=noo/N)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])","\n\\1",prey),
foo=noo/N)
ggplot(fooYears,aes(prey,foo,fill=Year))+
geom_bar(position="dodge")+
scale_fill_viridis_d()+
facet_wrap(~species,nrow=2)
ggplot(fooYears,aes(prey,foo,fill=Year))+
geom_col(position="dodge")+
scale_fill_viridis_d()+
facet_wrap(~species,nrow=2)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])","\n\\1",prey),
foo=noo/N,
Year=as.character(Year))
ggplot(fooYears,aes(prey,foo,fill=Year))+
geom_col(position="dodge")+
scale_fill_viridis_d()+
facet_wrap(~species,nrow=2)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d()+
facet_wrap(~Year,nrow=2)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d()+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_continuous(name="Diet Item")+
theme(axis.text.x=element_text(angle=20))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1))+
facet_wrap(~Year,nrow=3)
fooYears<-left_join(presenceYears,totalYears)%>%
pivot_longer(cols=matches("^prey"),names_to="prey",values_to="noo")%>%
ungroup()%>%
mutate(prey=gsub("^prey_","",prey),
prey=gsub("\\.([A-z])"," \\1",prey),
foo=noo/N,
Year=as.character(Year))
ggplot(fooYears,aes(prey,foo,fill=Year))+
geom_col(position="dodge")+
scale_fill_viridis_d()+
facet_wrap(~species,nrow=2)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=0))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.1))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.5))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.2))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12),
axis.title.x=element_text(vjust=1.5))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12),
axis.title.x=element_text(vjust=10))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12),
axis.title.x=element_text(vjust=5))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1),expand=expansion(add=0))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12),
axis.title.x=element_text(vjust=5))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=species))+
geom_col(position="dodge",color="black")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1),expand=expansion(add=0))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12),
axis.title.x=element_text(vjust=5))+
facet_wrap(~Year,nrow=3)
ggplot(fooYears,aes(prey,foo,fill=Year))+
geom_col(position="dodge",color="black")+
scale_fill_viridis_d(name="Species")+
scale_y_continuous(name="Frequency of Occurrence",limits=c(0,1),expand=expansion(add=0))+
scale_x_discrete(name="Diet Item")+
theme(axis.text.x=element_text(angle=20,hjust=1,vjust=1.12),
axis.title.x=element_text(vjust=5))+
facet_wrap(~species,nrow=2)
library(vegan)
library(RVAideMemoire)
library(usedist)
library(indicspecies)
#Duplicating with ALL the counts
allCount.Mat<-as.matrix(dplyr::select(dietMat,matches("^prey")))
allEnv.Mat<-as.matrix(dplyr::select(dietMat,-matches("^prey")))
View(allEnv.Mat)
View(allCount.Mat)
#Percent zeroes--number of zeroes times dim of matrix
(sum(allCount.Mat==0)/(nrow(allCount.Mat)*ncol(allCount.Mat)))*100
#Using the whole dataset--but can use the one without minor species (Jellyfish, Sea Angel)
set.seed(42)
#For the all diets NMDS
original.dist<-vegdist(allCount.Mat)
stress_values<-numeric(6)
r2<-numeric(6)
for (n in 1:6) {
nmds.resu <- metaMDS(allCount.Mat, k=n, distance = "bray", try=250, autotransform=F)
stress_values[n]<-nmds.resu$stress
nmds.scores<-vegan::scores(nmds.resu)
nmds.dist<-dist(nmds.scores)
r2[n]<-summary(lm(original.dist~nmds.dist))[[8]]
}
plot(stress_values, xlab="Number of axes", ylab="Stress",type="b")
abline(h=0.2,col="red")
View(stress_values)
#Go back and create the output for the 2 dimensions NMDS
count_NMDS<-metaMDS(allCount.Mat, distance = "bray", k = 1, try=250, autotransform=F)
r2<-summary(lm(original.dist~dist(vegan::scores(count_NMDS))))[[8]]
actualStress<-count_NMDS$stress
stressplot(count_NMDS) #This is the visual of stress, the divergence of observed and ordinated distance. It's random, that's good
#Print the species scores and sample scores
NMDS_species<-as.data.frame(count_NMDS$species)
NMDS_scores<-as.data.frame(count_NMDS$points)
viridis::viridis(n=3,end=0.95,option="C")
ggplot(data=NMDS_scores,aes(MDS1,MDS2))+
geom_polygon(data=NMDS_scores%>%group_by(time=allEnv.DF$Year)%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,fill=time,color=time),alpha=0.1,lwd=1.5,show.legend = F)+
geom_point(size=8,aes(fill=allEnv.DF$Year,shape=allEnv.DF$fortName))+
xlab("Axis 1 (20.8%)")+ylab("Axis 2 (18.1%)")
ggplot(data=NMDS_scores,aes(MDS1,MDS2))+
geom_polygon(data=NMDS_scores%>%group_by(time=allEnv.DF$Year)%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,fill=time,color=time),alpha=0.1,lwd=1.5,show.legend = F)+
geom_point(size=8)+
xlab("Axis 1 (20.8%)")+ylab("Axis 2 (18.1%)")
ggplot(data=NMDS_scores,aes(MDS1,MDS2))
#Need new axes R2 scores (from PC-ORD)
#Probably want to do the years on a plot and then a split 2017-2018 two panel plot (so 3 total)
ggplot(data=NMDS_scores,aes(MDS1))+
geom_polygon(data=NMDS_scores%>%group_by(time=allEnv.DF$Year)%>%slice(chull(MDS1,MDS2)),
aes(x=MDS1,y=MDS2,fill=time,color=time),alpha=0.1,lwd=1.5,show.legend = F)+
geom_point(size=8,aes(fill=allEnv.DF$Year,shape=allEnv.DF$fortName))+
xlab("Axis 1 (20.8%)")+ylab("Axis 2 (18.1%)")+
#stat_ellipse(data=allNMDS_DF,aes(color=paste(allEnv.DF$fortnight,allEnv.DF$Year)),
#            level=0.95,lwd=1.1,show.legend = F)+
geom_segment(data=NMDS_species, #all species
aes(x=0,y=0,xend=MDS1,yend=MDS2),color="grey50",lwd=1,alpha=0.5,show.legend = F)+
geom_segment(data=filter(NMDS_species,rownames(NMDS_species)%in%yIndSp$Species), #Just the indicator species
aes(x=0,y=0,xend=MDS1,yend=MDS2,color=yIndSp$time),lwd=1.1,show.legend = F)+ #Color coded to the group they're indicating
geom_label(data=filter(NMDS_species,rownames(NMDS_species)%in%yIndSp$Species), #Just the indicator species
aes(x=MDS1*1.1,y=MDS2*1.1,label=yIndSp$Species,color=yIndSp$time),size=8,show.legend = F)+ #Coded to the group they indicate
scale_color_viridis_d(begin=0.2,name="Year")+
scale_fill_viridis_d(begin=0.2,name="Year")+ #Same as 2017 and 2018 from above
scale_shape_manual(values=c(21,22,24),name="Time Period")+
scale_x_continuous(limits=c(-1.35,1.85))+
geom_text(aes(x=1.7,y=-1.35,label=paste0("Stress = ",round(actualStress*100,digits=2)),hjust=1),size=10)+
#geom_text(aes(x=1.5,y=1.4,label=paste0("MRPP Year p = ",round(countYear_MRPP$Pvalue,digits=4)),hjust=1),size=9)+
theme(legend.position=c(0.1,0.25),legend.background=element_rect(color="black"),legend.margin=margin(4,8,5,8),
legend.text=element_text(size=20),legend.title=element_text(size=22))+
guides(fill=guide_legend(title.hjust=0,label.vjust=0,override.aes=list(shape=21)))
#Probably want to do the years on a plot and then a split 2017-2018 two panel plot (so 3 total)
ggplot(data=NMDS_scores,aes(MDS1,1))
View(NMDS_scores)
#Need new axes R2 scores (from PC-ORD)
#Probably want to do the years on a plot and then a split 2017-2018 two panel plot (so 3 total)
ggplot(data=NMDS_scores,aes(MDS1,1))+geom_point()
View(NMDS_scores)
View(NMDS_species)
View(allCount.Mat)
#Go back and create the output for the 2 dimensions NMDS
count_NMDS<-metaMDS(allCount.Mat, distance = "bray", k = 2, try=250, autotransform=F)
r2<-summary(lm(original.dist~dist(vegan::scores(count_NMDS))))[[8]]
actualStress<-count_NMDS$stress
stressplot(count_NMDS) #This is the visual of stress, the divergence of observed and ordinated distance. It's random, that's good
#Need new axes R2 scores (from PC-ORD)
#Probably want to do the years on a plot and then a split 2017-2018 two panel plot (so 3 total)
ggplot(data=NMDS_scores,aes(MDS1,1))+geom_point()
#Need new axes R2 scores (from PC-ORD)
#Probably want to do the years on a plot and then a split 2017-2018 two panel plot (so 3 total)
ggplot(data=NMDS_scores,aes(MDS1,MSD2))+geom_point()
#Need new axes R2 scores (from PC-ORD)
#Probably want to do the years on a plot and then a split 2017-2018 two panel plot (so 3 total)
ggplot(data=NMDS_scores,aes(MDS1,MDS2))+geom_point()
#Print the species scores and sample scores
NMDS_species<-as.data.frame(count_NMDS$species)
NMDS_scores<-as.data.frame(count_NMDS$points)
ggplot(data=NMDS_scores,aes(MDS1,MDS2))+geom_point()
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_linerange(data=NMDS_species,aes(xmin=0,xmax=MDS1,ymin=0,ymax=MDS2))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_linerange(data=NMDS_species,aes(x=0,xmax=MDS1,y=0,ymax=MDS2))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_linerange(data=NMDS_species,aes(x=0,xmin=MDS1,y=0,ymin=MDS2))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_linerange(data=NMDS_species,aes(x=0,xmin=0,xmax=MDS1,y=0,ymin=0,ymax=MDS2))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names()))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,color=as.data.frame(allEnv.Mat$species)))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,color=as.data.frame(allEnv.Mat)$species))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
as.data.frame(allEnv.Mat)
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2,color=as.data.frame(allEnv.Mat)$Species))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
View(allEnv.Mat)
View(allCount.Mat)
which(allCount.Mat[,8]>0)
ggplot()+
geom_point(data=NMDS_scores[which(allCount.Mat[,8]>0),],aes(MDS1,MDS2,color=as.data.frame(allEnv.Mat)$Species))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
geom_point(data=NMDS_scores[which(allCount.Mat[,8]>0),],aes(MDS1,MDS2)+
ggplot()+
geom_point(data=NMDS_scores[which(allCount.Mat[,8]>0),],aes(MDS1,MDS2))
)
ggplot()+
geom_point(data=NMDS_scores[which(allCount.Mat[,8]>0),],aes(MDS1,MDS2))
ggplot()+
geom_point(data=NMDS_scores[which(allCount.Mat[,8]>0),],aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
#Go back and create the output for the 2 dimensions NMDS
count_NMDS<-metaMDS(allCount.Mat, distance = "bray", k = 3, try=250, autotransform=F)
r2<-summary(lm(original.dist~dist(vegan::scores(count_NMDS))))[[8]]
actualStress<-count_NMDS$stress
stressplot(count_NMDS) #This is the visual of stress, the divergence of observed and ordinated distance. It's random, that's good
#Print the species scores and sample scores
NMDS_species<-as.data.frame(count_NMDS$species)
NMDS_scores<-as.data.frame(count_NMDS$points)
ggplot()+
geom_point(data=NMDS_scores[which(allCount.Mat[,8]>0),],aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS3))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS2,MDS3))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=row.names(NMDS_species)))
library(plot3D)
plot3D::points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=30)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,tau=0)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,tau=90)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=90)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)+
segments3D(x0=0,y0=0,z0=0,x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)+
segments3D(x0=rep(0,nrow(NMDS_species)),y0=0,z0=0,x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)+
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,phi=0,theta=45,plot=F)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,phi=0,theta=45,add=T)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45)
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=45,theta=45)
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=45,theta=45,col="black")
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=45,theta=45,col="red")
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=0,theta=45,col="red")
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=30,theta=45,col="red")
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS2))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS2))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS2,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS1,MDS3))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS1,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS1,y=MDS3,label=row.names(NMDS_species)))
ggplot()+
geom_point(data=NMDS_scores,aes(MDS2,MDS3))+
geom_segment(data=NMDS_species,aes(x=0,xend=MDS2,y=0,yend=MDS3))+
geom_text(data=NMDS_species,aes(x=MDS2,y=MDS3,label=row.names(NMDS_species)))
points3D(NMDS_scores$MDS1,NMDS_scores$MDS2,NMDS_scores$MDS3,phi=30,theta=45,col="red")
segments3D(x0=rep(0,nrow(NMDS_species)),y0=rep(0,nrow(NMDS_species)),z0=rep(0,nrow(NMDS_species)),
x1=NMDS_species$MDS1,y1=NMDS_species$MDS2,z1=NMDS_species$MDS3,add=T)
